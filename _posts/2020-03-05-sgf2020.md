---
title: 'Bootstrap Resampling At Scale'
date: 2020-03-06 00:00:00
description: Automatically distributed bootstrap resampling
featured_image: '/images/blog/sgf2020/Slide 3.gif'
tags: clinical-trials workflow types-of-computing bootstrap resampling
---

# Using CAS In SAS Viya for Bootstrap Resampling And Faster Inference For Clinical Trial Results
Initially, this was going to be a demonstration presented at SAS Global Forum 2020.  I was looking forward to sharing this resampling action set project with this example demonstration.  The next best thing is learning a new way to present slides and annotate them in blog form.  Thank you for visiting and reviewing the following.  I welcome your feedback on the content as well as the presentation format!

![](/images/blog/sgf2020/Slide 1.png)

My copresenter, [Jesse Behrens](https://github.com/jessebehrens), giving feedback and encouragement is why this demonstration exists.  My first inclination was to wait a year due to a shoulder surgery prohibiting my travel and participation.  Instead of delaying, Jesse helped me out and prepared to present in my place.  Thank You!


![](/images/blog/sgf2020/Slide 2.png)

The [bootstrap](https://en.wikipedia.org/wiki/Bootstrapping_(statistics)) is a technique that allows us to learn from limited data and assess the uncertainty of our findings.  The technique is attributed to [Bradley Efron](http://statweb.stanford.edu/~ckirby/brad/), and its importance was recently acknowledged by awarding him the [International Prize in Statistics](https://statprize.org/previouswinners.cfm) in 2019.  


<img data-gifffer="/images/blog/sgf2020/Slide 3.gif">

The process of bootstrap resampling is simple to describe.  A resample is constructed by randomly drawing a case from the original sample, replace it, then repeat this up to the size of the resample.  This process repeats to construct the desired number of bootstrap resamples.  

This process can be easily parallelized by simultaneously taking drawings and doing each bootstrap resample at the same time on different computer processors. 

SAS Viya's [CAS engine](https://documentation.sas.com/?docsetId=viyaov&docsetTarget=n00000sasviya000architecture.htm&docsetVersion=3.5&locale=en#n08ohiggqnx6hsn1cx1b1cm41011) is a perfect environment to achieve this type of parallelization.  Instructions can be written once and distributed to all available compute processors via threads.  Let's take a closer look at SAS Viya's architecture to understand how all of this works.

In the animation above (click to play), we see the key components of SAS Viya displayed.  
- The first part is a SAS 9.4 workspace.  This component gives users a working SAS 9 session when they log into a SAS interface, such as SAS Studio.
- The second part is called CAS, which is a distributed computing environment made up of multiple servers working together.
- The CAS controller conducts the orchestration of work within CAS. Instructions are received and distributed to threads assigned to each processor in the CAS environment.
- The actual computation happens on CAS workers where each machine's processors have an assignment to computing threads. An environment can contain any number of CAS workers.

For bootstrap resampling, we want to request B resamples and have them evenly distribute across T threads.  For example, an environment may have 100 threads, that each goes to work processing 10 bootstrap resamples when we request 1000 total bootstrap resamples.

Let's look at how to send instructions to CAS on the next slide.

![](/images/blog/sgf2020/Slide 4.gif)

To trigger execution in a CAS environment, we have several options.  The most common way for SAS programmers to request computation is by using SAS code comprised of procs (procedures).  There are many new, [CAS enable procs](https://documentation.sas.com/?cdcId=pgmsascdc&cdcVersion=9.4_3.5&docsetId=allprodsproc&docsetTarget=p1o1v16by0iotvn10m0jzzv9i3y8.htm&locale=en) that direct their computations to occur in a CAS environment.  

Underneath procs, there is a new layer of programming available to SAS programmers with Viya.  These building blocks are called [CAS actions](https://documentation.sas.com/?cdcId=pgmsascdc&cdcVersion=9.4_3.5&docsetId=allprodsactions&docsetTarget=actionsByName.htm&locale=en).  There are many groups of actions that come with SAS Viya products, and these are called [action sets](https://documentation.sas.com/?cdcId=pgmsascdc&cdcVersion=9.4_3.5&docsetId=allprodsactions&docsetTarget=actionSetsByName.htm&locale=en). 

SAS Programmers can use these actions in a new proc, [PROC CAS](https://documentation.sas.com/?cdcId=pgmsascdc&cdcVersion=9.4_3.5&docsetId=proccas&docsetTarget=n1gq4olyaoyw7kn1g4hvz6gyoxoj.htm&locale=en).   This proc allows users to directly program and interact with CAS actions in a language called [CASL](https://documentation.sas.com/?cdcId=pgmsascdc&cdcVersion=9.4_3.5&docsetId=casl&docsetTarget=titlepage.htm&locale=en).

For users that are comfortable with other languages, like [R]() and [Python](https://documentation.sas.com/?cdcId=pgmsascdc&cdcVersion=9.4_3.5&docsetId=caspg3&docsetTarget=titlepage.htm&locale=en), these same actions get triggered via an API.  This functionality bypasses the need for a SAS interface, which has a SAS 9.4 workspace, by directly sending instructions to the CAS controller.

In our examples, we use CAS actions for bootstrap resampling from a SAS interface (SAS Studio) and use PROC CAS.

<img data-gifffer="/images/blog/sgf2020/Slide 5.gif">

The bootstrap resampling action is part of a [user-defined action set](https://documentation.sas.com/?cdcId=pgmsascdc&cdcVersion=9.4_3.5&docsetId=caspg&docsetTarget=cas-builtins-defineactionset.htm&locale=en) called resample.  This action set does not come with SAS Viya but is easily added to an environment from its [public GitHub repository](https://github.com/statmike/Resampling-Methods-in-SAS-Viya).  

The animation on this slide shows the whole process: download the single file from GitHub and run it from a SAS interface in the SAS Viya environment.  

![](/images/blog/sgf2020/Slide 6.gif)

The process of requesting bootstrap sampling gets fully specified in a single line of code, as highlighted in this slides animation. 

<img data-gifffer="/images/blog/sgf2020/Slide 7.gif">



![](/images/blog/sgf2020/Slide 8.png)



<img data-gifffer="/images/blog/sgf2020/Slide 9.gif">



![](/images/blog/sgf2020/Slide 10.png)



![](/images/blog/sgf2020/Slide 11.png)



![](/images/blog/sgf2020/Slide 12.gif)



![](/images/blog/sgf2020/Slide 13.gif)



![](/images/blog/sgf2020/Slide 14.png)



![](/images/blog/sgf2020/Slide 15.png)



![](/images/blog/sgf2020/Slide 16.png)



![](/images/blog/sgf2020/Slide 17.gif)



![](/images/blog/sgf2020/Slide 18.png)



![](/images/blog/sgf2020/Slide 19.png)



<img data-gifffer="/images/blog/sgf2020/Slide 20.gif">





<script type="text/javascript" src="/js/gifffer.min.js"></script>

<script>window.onload=function(){Gifffer();}</script>